У нас есть n супружеских пар. Значит всего людей 2n. Из них n женщин и n мужчин. За круглым столом есть 2n мест. Одна половина из них должна быть занята мужчинами, другая - женщинами. У нас есть n! способов рассадить мужчин и n! способов рассадить женщин. Но так же есть 2 способа выбрать, какие места займут женщины, а какие мужчины. Общее количество способов будет равно $2 * (n!)^2$. 
Формула включений-исключений для этой задачи: $\sum_{k = 0}^n (-1)^k C_n^k S_k$.
Пусть А - множество всех возможных рассадок пар за столом. Как мы уже выяснили, |A| = $2 * (n!)^2$.
Теперь нам нужно найти $S_k$.
Пусть $A_k$ - k-я пара села рядом. $S_k$ - k пар сидят рядом. Остальные n - k пар сидят отдельно. 
Сначала выберем k пар, которые будут сидеть вместе. Это можно сделать $C_n^k$ способами.
Теперь нам нужно разместить их за столом. Будем рассматривать одну пару как один блок. Количество способов рассадить оставшиеся n − k пар так, чтобы мужчины и женщины чередовались — это $(n - k)!^2$, так как есть (n - k)! способов мужчинам занять свои мужские места, и (n - k)! способов женщинам занять свои женские места. Учтем, то что внутри пары люди могут сидеть в двух возможных позициях - первый мужчина, вторая женщина, или наоборот. Кроме того, k блоков могут меняться местами между собой, что даст еще k! способов. 
Соберем все вместе. $S_k = d_k * 2^k * (n - k)!^2 * k!$. 
Вычислим $d_k$ - количество способов рассадить k супружеских пар так, чтобы эти пары сидели рядом и образовывали блоки. Нам нужно разместить k блоков среди 2n мест (мужских и женских). Количество способов - $C_{2n - k}^k$. Но нужно учесть, что блоки занимают два места (мужское и женское). Поэтому это число нужно скорректировать на количество способов разместить блоки. Домножим на $\frac{2n}{2n - k}$, так как k блоков занимают 2n − k мест, и эти блоки могут занимать различные комбинации мест среди мужских и женских позиций.
Итого, $d_k$ = $\frac{2n}{2n - k} * C_{2n - k}^k$.
$S_k = \frac{2n}{2n - k} * C_{2n - k}^k * 2^k * (n - k)!^2 * k!$.
Воспользуемся методом включений-исключений. 
Количество способов расположить за круглым столом n супружеских пар так, чтобы мужчины и женщины чередовались и никакие двое супругов не сидели рядом:
$\sum_{k = 0}^n (-1)^k C_n^k * 2 * \frac{2n}{2n - k} * k! * (n - k)!^2 * \frac{(2n - k)!}{k!(2n - 2k)!}$ = $\sum_{k = 0}^n (-1)^k C_n^k * 2n * (2n - k - 1)! * (n - k)!$
