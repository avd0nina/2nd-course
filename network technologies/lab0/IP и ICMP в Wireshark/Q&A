1. Что такое протокол IP? Как он обеспечивает глобальную адресацию?
IP (Internet Protocol) – это сетевой протокол, который обеспечивает адресацию и маршрутизацию пакетов данных между устройствами в сети. Он работает на сетевом уровне модели OSI и третьем уровне модели TCP/IP.
Глобальная адресация:
- Каждое устройство в сети получает уникальный IP-адрес, который позволяет определить его местоположение в сети.
- Маршрутизаторы используют IP-адреса для пересылки пакетов между разными сетями по оптимальному маршруту.
- Разделение на публичные и частные IP-адреса помогает организовать адресацию в масштабах всего интернета.

2. Каков формат IPv4-адреса? IPv6 адреса?
IPv4:
Представляет собой 32-битное число, записанное в десятичном виде с разделителями . (точками).
Пример: 192.168.1.1.
Длина: 4 байта (32 бита).
IPv6:
Представляет собой 128-битное число, записанное в шестнадцатеричном формате через : (двоеточия).
Пример: 2001:0db8:85a3:0000:0000:8a2e:0370:7334.
Длина: 16 байт (128 бит).

3. В чём смысл иерархичности IP-адресов?
IP-адреса структурированы иерархически, что упрощает маршрутизацию:
IPv4-адрес делится на две части:
1) Сетевая часть (определяет сеть).
2) Хостовая часть (определяет конкретное устройство в сети).
IPv6 также использует иерархию, но более гибко:
1) Префикс сети (определяет провайдера/организацию).
2) Идентификатор интерфейса (уникальный адрес устройства).
Преимущества иерархии:
- Уменьшает размер таблиц маршрутизации.
- Позволяет агрегировать маршруты (супернеттинг).

4. Какие заголовки есть у IP-дейтаграммы?
Заголовок IPv4 содержит:
- Версия (4 бита) – версия протокола (IPv4 или IPv6).
- Длина заголовка (4 бита) – размер заголовка.
- Тип обслуживания (8 бит) – приоритет пакета.
- Общая длина (16 бит) – полный размер дейтаграммы.
- Идентификатор (16 бит) – используется для фрагментации.
- Флаги (3 бита) – контроль фрагментации.
- Смещение фрагмента (13 бит) – положение фрагмента в пакете.
- TTL (8 бит) – время жизни пакета.
- Протокол (8 бит) – указывает протокол верхнего уровня (TCP, UDP).
- Контрольная сумма (16 бит) – проверка ошибок заголовка.
- Адрес отправителя (32 бита).
- Адрес получателя (32 бита).
IPv6 заголовок проще:
- Убраны ненужные поля, увеличены адреса (128 бит).
- Добавлены механизмы QoS (качество обслуживания).

5. Что такое TTL?
TTL (Time To Live) – это поле в заголовке IP-пакета, которое ограничивает его время жизни в сети.
Как это работает?
Каждый маршрутизатор уменьшает TTL на 1.
Если TTL достиг 0, пакет отбрасывается, а отправителю посылается ICMP-сообщение Time Exceeded.
Зачем? Чтобы пакеты не зацикливались бесконечно в сети.

6. Зачем нужен протокол ICMP? 
ICMP (Internet Control Message Protocol) – это вспомогательный протокол для передачи диагностических сообщений.
Используется для:
- Оповещения об ошибках (Destination Unreachable, Time Exceeded).
- ping – проверка доступности узлов.
- traceroute – трассировка маршрута.

7. Как traceroute использует ICMP для построения пути?
- Отправляет UDP-пакеты с увеличивающимся TTL.
- Маршрутизаторы по пути отправляют ICMP Time Exceeded, если TTL истёк.
- traceroute записывает IP-адрес каждого маршрутизатора.

8. Что такое NAT? Какие проблемы он решает? А какие создает?
NAT (Network Address Translation) – механизм трансляции частных IP-адресов в публичные.
Плюсы NAT:
- Экономия IPv4-адресов.
- Скрывает внутреннюю сеть (безопасность).
Минусы NAT:
- Ломает end-to-end соединение.
- Проблемы с P2P, VPN, VoIP.

9. Зачем нужна версия протокола IPv6? 
- Больше адресов (128 бит).
- Убрана NAT-зависимость.
- Поддержка QoS и Multicast.
- Лучше защищена (IPsec встроен).

10. Какие существуют протоколы роутинга? Зачем они нужны?
Роутинг – выбор пути доставки пакетов.
Протоколы:
- RIP (Routing Information Protocol) – простой, но медленный (расстояние-вектор).
- OSPF (Open Shortest Path First) – быстрый, масштабируемый (состояние канала).
- BGP (Border Gateway Protocol) – основной протокол интернета (автономные системы).

11. Что такое автономная система?
AS (Autonomous System) – это группа IP-сетей под единым администрированием, имеющая единую политику маршрутизации.
Виды маршрутизации между AS:
- IGP (Internal Gateway Protocols) – для маршрутов внутри AS (RIP, OSPF).
- EGP (External Gateway Protocols) – для обмена маршрутами между AS (BGP).

Вопросы по канальному уровню

Канальный слой отвечает за доставку пакетов от одного узла сети к другому (передача данных между устройствами внутри одной сети)
Некоторые протоколы канального слоя даже могут дать гарантию доставки пакета от одного узла к другому
Примеры: Ethernet, Wi-Fi
Пакет канального уровня называется кадром или фреймом (frame)

Основные функции канального уровня
- Разделение данных на кадры
- Канальный уровень разбивает сетевые пакеты (IP) на кадры, добавляя заголовок и контрольную сумму.
- Адресация в локальной сети
- Использует MAC-адреса (уникальные аппаратные адреса сетевых карт) для идентификации отправителя и получателя в одной сети.
- Обнаружение и исправление ошибок
- Включает контрольные суммы (CRC) в кадры, чтобы обнаруживать повреждения данных.
- Доступ к среде передачи (Media Access Control, MAC)
- Определяет, кто может передавать данные в данный момент.
- Используются протоколы управления доступом: CSMA/CD (Ethernet), CSMA/CA (Wi-Fi), TDMA (мобильные сети).
- Обнаружение и обработка коллизий
- В Ethernet применяется CSMA/CD – механизм предотвращения коллизий при передаче данных.

Как канальный уровень взаимодействует с другими уровнями:
- Получает пакеты с сетевого уровня (IP), оборачивает их в кадры и отправляет на физический уровень.
- Принимает кадры с физического уровня, проверяет их и передает сетевому уровню.

Пример работы канального уровня:
Допустим, компьютер A (MAC: 00:1A:2B:3C:4D:5E) хочет отправить данные компьютеру B (MAC: 00:1A:2B:3C:4D:5F) в одной сети:
Компьютер A формирует IP-пакет (сетевой уровень).
Канальный уровень A добавляет MAC-адреса и создает Ethernet-кадр.
Кадр отправляется через физическую среду (например, кабель).
Компьютер B принимает кадр, проверяет MAC-адрес, извлекает IP-пакет и передает его сетевому уровню.

14. Как сетевой уровень взаимодействует с канальным? Зачем нужен протокол ARP?
Сетевой уровень (например, IP) отвечает за логическую адресацию и маршрутизацию, а канальный (например, Ethernet, Wi-Fi) – за передачу данных в пределах одной сети.
Взаимодействие происходит следующим образом:
1) Сетевой уровень формирует IP-пакет и передает его на канальный уровень.
2) Канальный уровень добавляет MAC-адреса отправителя и получателя, создавая Ethernet-кадр.
3) Кадр передается по физической сети (кабель, Wi-Fi и т. д.).
4) На принимающей стороне канальный уровень извлекает IP-пакет и передает его на сетевой уровень.
Но как определить MAC-адрес устройства, если известен только IP? Для этого используется протокол ARP.
Протокол ARP (Address Resolution Protocol - протокол разрешения адресов) сопоставляет IP-адреса с MAC-адресами в локальной сети.
Когда устройство отправляет данные:
- Оно проверяет свою ARP-таблицу (кеш), чтобы узнать MAC-адрес получателя.
- Если MAC-адрес неизвестен, устройство отправляет ARP-запрос (широковещательный пакет).
- Владелец нужного IP-адреса отвечает ARP-ответом, передавая свой MAC-адрес.
- Устройство сохраняет MAC-адрес в ARP-кеше и отправляет кадр.

15.В чем отличие IP-адресации (сетевой уровень) от MAC-адресации (канальный уровень)?
IP-адресация (сетевой уровень) отвечает за логическую адресацию и маршрутизацию данных между различными сетями. IP-адреса могут изменяться, они выдаются провайдером или локальным администратором и могут быть динамическими (например, через DHCP). IP-адрес указывает, где находится устройство в сети и позволяет передавать пакеты через маршрутизаторы.
MAC-адресация (канальный уровень) используется для передачи данных внутри одной локальной сети (LAN). MAC-адрес — это уникальный физический адрес сетевого адаптера, присваиваемый производителем оборудования. Он не меняется при перемещении устройства в разные сети (если не изменять его программно). MAC-адрес указывает, кто именно получает данные в пределах одной сети.
Таким образом, IP-адрес помогает находить устройства в глобальной сети (Интернет), а MAC-адрес позволяет доставлять данные конкретному устройству внутри локальной сети. Если данные пересекают границы сети, маршрутизатор заменяет MAC-адрес, но IP-адрес остается тем же.
